{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React from 'react';\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { _id, _secret } from \"../../helpers/data.json\";\nimport axios from 'axios';\nimport Informations from \"../Informations\";\nimport { authorize } from 'react-native-app-auth';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar Home = function Home(_ref) {\n  var navigation = _ref.navigation;\n  var styles = StyleSheet.create({\n    container: {\n      flex: 1,\n      justifyContent: 'center',\n      alignItems: 'center',\n      backgroundColor: \"#011F26\"\n    },\n    input: {\n      height: 40,\n      width: 200,\n      marginBottom: 12,\n      borderWidth: 1,\n      padding: 10,\n      borderRadius: 5,\n      backgroundColor: \"#FFF\"\n    },\n    button: {\n      backgroundColor: \"#5C7373\",\n      width: 160,\n      padding: 15,\n      alignItems: 'center',\n      justifyContent: 'center',\n      borderRadius: 5,\n      alignSelf: 'center'\n    }\n  });\n\n  var _React$useState = React.useState(\"\"),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      login = _React$useState2[0],\n      onChangeLogin = _React$useState2[1];\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      loading = _React$useState4[0],\n      setLoading = _React$useState4[1];\n\n  var config = {\n    authorizationEndpoint: \"\" + AUTHORIZATION_ENDPOINT,\n    tokenEndpoint: \"\" + TOKEN_ENDPOINT\n  };\n\n  var askLogin = function askLogin() {\n    var _useAuthRequest, _useAuthRequest2, request, response, promptAsync;\n\n    return _regeneratorRuntime.async(function askLogin$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _useAuthRequest = useAuthRequest({\n              clientId: _id,\n              scopes: [\"public\"],\n              redirectUri: \"com.smoudene.companion://redirect\",\n              responseType: \"code\"\n            }, config), _useAuthRequest2 = _slicedToArray(_useAuthRequest, 3), request = _useAuthRequest2[0], response = _useAuthRequest2[1], promptAsync = _useAuthRequest2[2];\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var getAccessToken = function getAccessToken() {\n    var token;\n    return _regeneratorRuntime.async(function getAccessToken$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(axios.post(\"https://api.intra.42.fr/oauth/token/\", {\n              client_id: _id,\n              client_secret: _secret,\n              grant_type: \"client_credentials\"\n            }));\n\n          case 3:\n            token = _context2.sent;\n\n            if (!token.data) {\n              _context2.next = 7;\n              break;\n            }\n\n            console.log(token.data);\n            return _context2.abrupt(\"return\", token.data);\n\n          case 7:\n            _context2.next = 12;\n            break;\n\n          case 9:\n            _context2.prev = 9;\n            _context2.t0 = _context2[\"catch\"](0);\n            return _context2.abrupt(\"return\", null);\n\n          case 12:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 9]], Promise);\n  };\n\n  var Tokeninfos = function Tokeninfos(token) {\n    var infos;\n    return _regeneratorRuntime.async(function Tokeninfos$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(axios.get(\"https://api.intra.42.fr/oauth/token/info\", {\n              headers: {\n                Authorization: \"Bearer \" + token\n              }\n            }));\n\n          case 3:\n            infos = _context3.sent;\n\n            if (!infos.data) {\n              _context3.next = 7;\n              break;\n            }\n\n            console.log(infos.data);\n            return _context3.abrupt(\"return\", infos.infos);\n\n          case 7:\n            _context3.next = 12;\n            break;\n\n          case 9:\n            _context3.prev = 9;\n            _context3.t0 = _context3[\"catch\"](0);\n            return _context3.abrupt(\"return\", null);\n\n          case 12:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[0, 9]], Promise);\n  };\n\n  var getInfos = function getInfos(login, token) {\n    var response, coalition;\n    return _regeneratorRuntime.async(function getInfos$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.prev = 0;\n            _context4.next = 3;\n            return _regeneratorRuntime.awrap(axios.get(\"https://api.intra.42.fr/v2/users/\" + login.trim().toLowerCase(), {\n              headers: {\n                Authorization: \"Bearer \" + token.access_token\n              }\n            }));\n\n          case 3:\n            response = _context4.sent;\n\n            if (!response.data) {\n              _context4.next = 9;\n              break;\n            }\n\n            _context4.next = 7;\n            return _regeneratorRuntime.awrap(axios.get(\"https://api.intra.42.fr/v2/users/\" + response.data.id + \"/coalitions\", {\n              headers: {\n                Authorization: \"Bearer \" + token.access_token\n              }\n            }));\n\n          case 7:\n            coalition = _context4.sent;\n\n            if (coalition.data) {\n              setLoading(false);\n              navigation.navigate(\"Informations\", {\n                data: response.data,\n                coalition: coalition.data\n              });\n            }\n\n          case 9:\n            _context4.next = 16;\n            break;\n\n          case 11:\n            _context4.prev = 11;\n            _context4.t0 = _context4[\"catch\"](0);\n            console.log(_context4.t0.message);\n            alert(\"login doesnt exist\");\n            setLoading(false);\n\n          case 16:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[0, 11]], Promise);\n  };\n\n  var fetchLogin = function fetchLogin(login) {\n    var token;\n    return _regeneratorRuntime.async(function fetchLogin$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            setLoading(true);\n            login.trim();\n\n            if (!(login && login !== \"\")) {\n              _context5.next = 37;\n              break;\n            }\n\n            _context5.prev = 3;\n            _context5.next = 6;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"access_token\"));\n\n          case 6:\n            token = _context5.sent;\n\n            if (!token) {\n              _context5.next = 20;\n              break;\n            }\n\n            token = JSON.parse(token);\n            console.log(\"token kayn\", token);\n\n            if (!Tokeninfos(token.access_token)) {\n              _context5.next = 18;\n              break;\n            }\n\n            console.log(\"expired\");\n            _context5.next = 14;\n            return _regeneratorRuntime.awrap(getAccessToken());\n\n          case 14:\n            token = _context5.sent;\n\n            if (!token) {\n              _context5.next = 18;\n              break;\n            }\n\n            _context5.next = 18;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"access_token\", JSON.stringify(token)));\n\n          case 18:\n            _context5.next = 26;\n            break;\n\n          case 20:\n            _context5.next = 22;\n            return _regeneratorRuntime.awrap(getAccessToken());\n\n          case 22:\n            token = _context5.sent;\n\n            if (!token) {\n              _context5.next = 26;\n              break;\n            }\n\n            _context5.next = 26;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"access_token\", JSON.stringify(token)));\n\n          case 26:\n            _context5.next = 28;\n            return _regeneratorRuntime.awrap(getInfos(login, token));\n\n          case 28:\n            _context5.next = 35;\n            break;\n\n          case 30:\n            _context5.prev = 30;\n            _context5.t0 = _context5[\"catch\"](3);\n            console.log(_context5.t0);\n            alert(_context5.t0);\n            setLoading(false);\n\n          case 35:\n            _context5.next = 38;\n            break;\n\n          case 37:\n            alert(\"you should set a login first\");\n\n          case 38:\n            setLoading(false);\n\n          case 39:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, [[3, 30]], Promise);\n  };\n\n  return _jsx(View, {\n    style: styles.container,\n    children: !loading ? _jsxs(View, {\n      style: styles.viewContainer,\n      children: [_jsx(TextInput, {\n        style: styles.input,\n        onChangeText: onChangeLogin,\n        value: login,\n        placeholder: \"Login\"\n      }), _jsx(Pressable, {\n        style: styles.button,\n        onPress: function onPress() {\n          return askLogin();\n        },\n        children: _jsx(Text, {\n          style: styles.text,\n          children: \"Search\"\n        })\n      })]\n    }) : _jsx(ActivityIndicator, {\n      size: \"large\",\n      color: \"#00b0b2\"\n    })\n  });\n};\n\nexport default Home;","map":{"version":3,"sources":["/Users/smoudene/Desktop/swiftyC/Views/Home/index.js"],"names":["React","AsyncStorage","_id","_secret","axios","Informations","authorize","Home","navigation","styles","StyleSheet","create","container","flex","justifyContent","alignItems","backgroundColor","input","height","width","marginBottom","borderWidth","padding","borderRadius","button","alignSelf","useState","login","onChangeLogin","loading","setLoading","config","authorizationEndpoint","AUTHORIZATION_ENDPOINT","tokenEndpoint","TOKEN_ENDPOINT","askLogin","useAuthRequest","clientId","scopes","redirectUri","responseType","request","response","promptAsync","getAccessToken","post","client_id","client_secret","grant_type","token","data","console","log","Tokeninfos","get","headers","Authorization","infos","getInfos","trim","toLowerCase","access_token","id","coalition","navigate","message","alert","fetchLogin","getItem","JSON","parse","setItem","stringify","viewContainer","text"],"mappings":"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","sourcesContent":["import React from 'react'\nimport {Image, ImageBackground, SafeAreaView, Text, TextInput, TouchableWithoutFeedback,ActivityIndicator , View,StyleSheet,Pressable} from \"react-native\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport {_id, _secret} from \"../../helpers/data.json\"\nimport axios from 'axios';\nimport Informations from '../Informations';\nimport { authorize } from 'react-native-app-auth';\n\nconst Home = ({navigation}) => {\n\n  const styles = StyleSheet.create({\n    container:{\n      flex: 1,\n      justifyContent: 'center',\n      alignItems: 'center',\n      backgroundColor : \"#011F26\"\n    },\n    input: {\n      height: 40,\n      width: 200,\n      marginBottom: 12,\n      borderWidth: 1,\n      padding: 10,\n      borderRadius : 5,\n      backgroundColor : \"#FFF\"\n    },\n    button: {\n      backgroundColor: \"#5C7373\",\n      width: 160,\n      padding: 15,\n      alignItems: 'center',\n      justifyContent: 'center',\n      borderRadius: 5,\n      alignSelf : 'center'\n  },\n  });\n\n  const [login, onChangeLogin] = React.useState(\"\");\n  const [loading, setLoading] = React.useState(false);\n\n//   https://api.intra.42.fr/oauth/authorize?client_id=2582e5ab9cef84a4205e746b98e7b456fd1b1b68a37c7131e974daae1b3de7ac&redirect_uri=http%3A%2F%2Flocalhost%3A19006%2F&response_type=code\n\nconst config = {\n    authorizationEndpoint: `${AUTHORIZATION_ENDPOINT}`,\n    tokenEndpoint: `${TOKEN_ENDPOINT}`,\n  };\nconst askLogin = async () => {\n    const [request, response, promptAsync] = useAuthRequest(\n        {\n          clientId: _id,\n          scopes: [\"public\"],\n          redirectUri: \"com.smoudene.companion://redirect\",\n          responseType: \"code\",\n        },\n        config\n      );\n};\n  const getAccessToken = async () => {\n      try {\n          const token = await axios.post(\"https://api.intra.42.fr/oauth/token/\", {\n              client_id: _id,\n              client_secret: _secret,\n              grant_type: \"client_credentials\",\n          });\n\n          if (token.data) {\n              console.log(token.data)\n              return token.data;\n          }\n      } catch (error) {\n          return null;\n      }\n  };\n  const Tokeninfos = async (token) => {\n    try {\n        const infos = await axios.get(\"https://api.intra.42.fr/oauth/token/info\", {\n            headers: { \n                Authorization: \"Bearer \" + token,\n            },\n        });\n        if (infos.data) {\n            console.log(infos.data)\n            return infos.infos;\n        }\n    } catch (error) {\n        return null;\n    }\n};\n  // console.log(\"hna\",token)\n const getInfos = async (login, token) => {\n  try {\n    var response = await axios.get(\n        \"https://api.intra.42.fr/v2/users/\" + (login.trim()).toLowerCase(),\n        {\n            headers: {\n                Authorization: \"Bearer \" + token.access_token,\n            },\n        }\n    );\n    if (response.data) {\n    //   console.log(\"datadata\",response.data)\n        var coalition = await axios.get(\n            \"https://api.intra.42.fr/v2/users/\"+response.data.id+\"/coalitions\",\n            {\n                headers: {\n                    Authorization: \"Bearer \" + token.access_token,\n                },\n            }\n        )\n        if (coalition.data) {\n            setLoading(false);\n            navigation.navigate(\"Informations\", { data: response.data, coalition: coalition.data });\n        }\n    }\n    } catch (error) {\n    console.log(error.message);\n    alert(\"login doesnt exist\");\n    setLoading(false);\n    }\n}; \n\n\nconst fetchLogin = async (login) => {\n    setLoading(true);\n  login.trim();\n  if (login && login !== \"\") {\n      try {\n          var token = await AsyncStorage.getItem(\"access_token\");\n          if (token) {\n              token = JSON.parse(token);\n              console.log(\"token kayn\",token)\n              if (Tokeninfos(token.access_token)) {\n                  console.log(\"expired\");\n                  token = await getAccessToken();\n                  if (token)\n                      await AsyncStorage.setItem(\"access_token\", JSON.stringify(token));\n              }\n          }\n          else {\n              token = await getAccessToken();\n              if (token)\n                  await AsyncStorage.setItem(\"access_token\", JSON.stringify(token));\n          }\n          await getInfos(login, token);\n      }\n      catch (error) {\n          console.log(error);\n          alert(error);\n          setLoading(false);\n      }\n\n  }\n  else\n      alert(\"you should set a login first\");\n      setLoading(false);\n}\n\n\n\n  return (\n    <View style={styles.container} >\n         {!loading ?\n                    <View style={styles.viewContainer}>\n                        <TextInput\n                            style={styles.input}\n                            onChangeText={onChangeLogin}\n                            value={login}\n                            placeholder=\"Login\"\n                        />\n                        <Pressable\n                            style={styles.button}\n                            onPress={() => askLogin() }\n                        >\n                            <Text style={styles.text}>Search</Text>\n                        </Pressable>\n                    </View>\n                    : <ActivityIndicator size=\"large\" color=\"#00b0b2\" />}\n    </View>\n  )\n}\n\nexport default Home"]},"metadata":{},"sourceType":"module"}